<!-- View for Donors to See Organiation -->

<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCmvJ9enZrdIcZfNQxj8c-FA1eTqKPrDtk&callback=initialize" type="text/javascript"></script>


<html>

 <%= render 'layouts/header' %>

<h1><%=@org.name%></h1>



<div class = "margin">

  <div id="map" style='width: 400px; height: 400px;'></div>
</div>

<div >
  <h1 style = 'margin-top:60px;'>About</h1>
  <h5><%=@org.about%></h5>
</div>

<div class = "info">

  <div class = "one">
  <%= image_tag "gps.png",  height: '32', width: '32' %>
  </div>

  <div class = "two">
  <p class = "margin"><%=@org.address%><br><%=@org.address_line_2||="Berkeley, CA 94709"%></p>
  </div>

  <div class = "one" >
  <%= image_tag "telephone.png", height: '32', width: '32' %>
  </div>

  <div class = "two">
  <p ><%=@org.phone_number||="409-870-8888"%></p>

  </div>

</div>

<h1 class = "margin" style = 'margin-top:100px;'>Registry Items</h1>

<% if @org.registry_items.length > 0%>

<div class = "row">

<table class = "flat-table" >
  <tr>
    <th>&nbsp;&nbsp;&nbsp;Item</th>
    <th class = "format">Needed</th>
    <th class = "format">Pledged</th>
    <th></th>
  </tr>



  <% @org.registry_items.each do |item| %>
    <% if item.amount_needed != 0 %>
    	<tr>
      	<td><%=item.name %></td>
      	<td class = "format"><%= item.amount_needed||=0 %></td>
      	<td class = "format"><%= item.amount_pledged||=0 %></td>
      	<td class = "format"><%= link_to "pledge", 'pledges/new?' + 'item_id=' + item.id.to_s %></td>
      </tr>
    <%end%>
  <%end%>



</table>

</div>

<%else%>
  <h5 style = "margin-top:60px">This organization currently has no registry items.  Check back later!<h5>
<%end%>

<%= hidden_field_tag "lat", :value => @org.lat, :id=>"lat" %>
<%= hidden_field_tag "lon", :value => @org.lon, :id=>"lon" %>



</html>

<script>
      //{:value=>37.325386, :id=>"lat"}


      var lat = parseFloat($('#lat').val().split(',')[0].split('>')[1])
      var lon = parseFloat($('#lon').val().split(',')[0].split('>')[1])


      var map = new google.maps.Map(document.getElementById('map'), {
        center: {lat: lat, lng: lon},
        zoom: 12
        });
      var marker = new google.maps.Marker({
        position:  {lat: lat, lng: lon},
        map: map
      });

</script>




